<!DOCTYPE html>
<html>
<head>
  <title>Diferentes formatos de datos</title>
  <meta charset="utf-8">
  <meta name="description" content="Diferentes formatos de datos">
  <meta name="author" content="Valentín Vergara Hidd">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/phone.css" 
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->  <link rel=stylesheet href="libraries/widgets/quiz/css/demo.css"></link>
<link rel=stylesheet href="libraries/widgets/bootstrap/css/bootstrap.css"></link>
<link rel=stylesheet href="./assets/css/ribbons.css"></link>

  
  <!-- Grab CDN jQuery, fall back to local if offline -->
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery.js"><\/script>')</script> 
  <script data-main="libraries/frameworks/io2012/js/slides" 
    src="libraries/frameworks/io2012/js/require-1.0.8.min.js">
  </script>
  
  

</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">
    
    <!-- LOGO SLIDE -->
      <slide class="nobackground">
    <article class="flexbox vcenter">
      <span>
        <img width='300px' src="assets/img/marcaderecha.png">
      </span>
    </article>
  </slide>
    <slide class="title-slide segue nobackground">
  <aside class="gdbar">
    <img src="assets/img/escudoof.gif">
  </aside>
  <hgroup class="auto-fadein">
    <h1>Diferentes formatos de datos</h1>
    <h2>Transformaciones, importaciones y exportaciones desde R.</h2>
    <p>Valentín Vergara Hidd<br/></p>
  </hgroup>
  <article></article>  
</slide>
    

    <!-- SLIDES -->
    <slide class="segue" id="slide-1" style="background:lightgreen;">
  <hgroup>
    <h1>Diferentes formatos de archivo</h1>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-2" style="background:lightgreen;">
  <hgroup>
    <h2>Archivos de SPSS</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-3" style="background:;">
  <hgroup>
    <h2>Formatos</h2>
  </hgroup>
  <article data-timings="">
    <p>R puede leer prácticamente cualquier tipo de archivo. Desde texto plano hasta algunos propietarios como SPSS, SAS, Stata, etc.</p>

<p>La ventaja de esto es que no necesitamos más que R y algunos paquetes instalados para poder empezar a trabajar con datos que otros han desarrollado para sus propios objetivos (datos secundarios.)</p>

<p>Para ello, es fundamental trabajar con el paquete <strong>foreign</strong>. Se instala de esta forma.</p>

<pre><code class="r">install.packages(&quot;foreign&quot;, repos = &#39;https://dirichlet.mat.puc.cl/&#39;)
</code></pre>

<pre><code>## Installing package into &#39;/usr/local/lib/R/site-library&#39;
## (as &#39;lib&#39; is unspecified)
</code></pre>

<p>Con este paquete, podremos leer archivos en formatos propietarios. </p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="class" id="id" style="background:;">
  <hgroup>
    <h2>Primer ejemplo: SPSS.</h2>
  </hgroup>
  <article data-timings="">
    <p>El primer archivo que vamos a trabajar está hecho para SPSS. Se llama [examen.sav] y lo pueden encontrar en INFODA. Para leerlo, hay que cargar el paquete <strong>foreign</strong>, previamente instalado y a continuación creamos un objeto [spss1] que contenga los datos, utilizando para ello la función <em>read.spss</em>.</p>

<pre><code class="r">library(foreign)
spss1&lt;-read.spss(&quot;./examen.sav&quot;, to.data.frame = TRUE)
</code></pre>

<pre><code>## re-encoding from latin1
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-5" style="background:;">
  <article data-timings="">
    <p>Para conocer el contenido del objeto [spss1], podemos usar la función str.</p>

<pre><code class="r">str(spss1)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  3 variables:
##  $ puntaje : num  62 58 52 55 75 82 38 55 48 68 ...
##  $ horas   : num  40 31 35 26 51 48 25 37 30 44 ...
##  $ ansiedad: num  40 65 34 91 46 52 48 61 34 74 ...
##  - attr(*, &quot;variable.labels&quot;)= Named chr  &quot;Puntaje en el Examen&quot; &quot;Horas de preparación (estudio)&quot; &quot;Escala de Ansiedad&quot;
##   ..- attr(*, &quot;names&quot;)= chr  &quot;puntaje&quot; &quot;horas&quot; &quot;ansiedad&quot;
##  - attr(*, &quot;codepage&quot;)= int 28591
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-6" style="background:;">
  <article data-timings="">
    <p>O bien, si lo que nos interesa simplemente es el nombre de cada una de las variables del <em>dataframe</em> [spss1]:</p>

<pre><code class="r">names(spss1)
</code></pre>

<pre><code>## [1] &quot;puntaje&quot;  &quot;horas&quot;    &quot;ansiedad&quot;
</code></pre>

<p>Luego, para conocer sus dimensiones, la función es:</p>

<pre><code class="r">dim(spss1)
</code></pre>

<pre><code>## [1] 20  3
</code></pre>

<p>El resultado de esta función indica que hay 20 filas y 3 columnas; lo que es igual a 20 casos en 3 variables.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-7" style="background:;">
  <hgroup>
    <h2>Modificar el dataframe</h2>
  </hgroup>
  <article data-timings="">
    <p>Imaginemos que estamos interesados en  crear una nueva variable, que llamaremos [hombre] y cuyo valor será 1 si la persona es hombre; y 0 en cualquier otro caso. Como no poseemos la información, lo haremos de forma aleatoria. Para ello, vamos a crear un objeto [hombre], con 20 valores al azar.</p>

<pre><code class="r">hombre&lt;-sample(c(0,1),20,replace = TRUE)
</code></pre>

<p>Y luego, crearemos un objeto [spss2], donde se incluirá [hombre] a los contenidos de [spss1]</p>

<pre><code class="r">spss2&lt;-cbind(spss1,hombre)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-8" style="background:;">
  <article data-timings="">
    <p>Para asegurarnos que se creó, veamos las primeras 6 filas del objeto [spss2]:</p>

<pre><code class="r">head(spss2)
</code></pre>

<pre><code>##   puntaje horas ansiedad hombre
## 1      62    40       40      0
## 2      58    31       65      0
## 3      52    35       34      0
## 4      55    26       91      1
## 5      75    51       46      1
## 6      82    48       52      0
</code></pre>

<p>Luego, nos aseguramos que el objeto [spss2] sea aún un objeto de tipo <em>dataframe</em></p>

<pre><code class="r">is.data.frame(spss2)
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-9" style="background:;">
  <hgroup>
    <h2>Exportar los datos</h2>
  </hgroup>
  <article data-timings="">
    <p>En la mayoría de los casos, no debería ser necesario exportar los datos a otro formato, dado que todo lo que se ha hecho en una sesión de R queda guardado en el script (el archivo con extensión .R). Sin embargo, en los casos que se quiera exportar, el paquete <strong>foreign</strong> tiene la función write.foreign.</p>

<pre><code class="r">write.foreign(spss2, &quot;./datos.txt&quot;, &quot;./datos.sps&quot;, package = &quot;SPSS&quot;)
</code></pre>

<p>Los archivos resultantes se deberían poder leer desde SPSS.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-10" style="background:lightgreen;">
  <hgroup>
    <h2>Planillas de Cálculo creadas con MS Excel</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-11" style="background:;">
  <hgroup>
    <h2>Instalación de paquetes.</h2>
  </hgroup>
  <article data-timings="">
    <p>Existen varios paquetes que permiten leer planillas de cáculo creadas con MS Excel, con la desventaja de necesitar dependencias externas para funcionar (Java, Pearl, OCDB, etc). Por tanto, trabajaremos con el paquete que no requiere dependencias externas.</p>

<pre><code class="r">install.packages(&quot;readxl&quot;, repos = &#39;https://dirichlet.mat.puc.cl/&#39;)
</code></pre>

<pre><code>## Installing package into &#39;/usr/local/lib/R/site-library&#39;
## (as &#39;lib&#39; is unspecified)
</code></pre>

<pre><code class="r">library(readxl)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-12" style="background:;">
  <hgroup>
    <h2>Lectura de los datos.</h2>
  </hgroup>
  <article data-timings="">
    <p>Vamos a trabajar con la planilla <strong>survey.xls</strong>, disponible en INFODA. Para ello, crearemos un objeto [excel1] que contenga la planilla.</p>

<pre><code class="r">excel1&lt;-read_excel(&quot;./survey.xlsx&quot;)
</code></pre>

<p>Para ver los nombres de las variables, utilizamos la función names.</p>

<pre><code class="r">names(excel1)
</code></pre>

<pre><code>## [1] &quot;id&quot;           &quot;satisfaccion&quot; &quot;edad&quot;         &quot;escolaridad&quot; 
## [5] &quot;sexo&quot;         &quot;transporte&quot;   &quot;casado&quot;       &quot;mot_trab&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-13" style="background:;">
  <hgroup>
    <h2>Más información sobre los datos.</h2>
  </hgroup>
  <article data-timings="">
    <p>Copmo alternativa, si se quiere obtener más información del dataframe:</p>

<pre><code class="r">str(excel1)
</code></pre>

<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    79 obs. of  8 variables:
##  $ id          : chr  &quot;001&quot; &quot;002&quot; &quot;003&quot; &quot;004&quot; ...
##  $ satisfaccion: num  84.7 82.8 68.2 70 81.4 87.7 68.7 89.2 88.7 85.6 ...
##  $ edad        : num  29 21 21 23 29 47 45 21 46 28 ...
##  $ escolaridad : num  12 12 12 11 12 12 10 12 14 14 ...
##  $ sexo        : chr  &quot;M&quot; &quot;M&quot; &quot;F&quot; &quot;F&quot; ...
##  $ transporte  : chr  &quot;BUS&quot; &quot;CAR&quot; &quot;CAR&quot; &quot;CAR&quot; ...
##  $ casado      : num  1 1 0 0 1 1 0 1 1 0 ...
##  $ mot_trab    : num  1 1 1 2 1 3 3 1 2 1 ...
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-14" style="background:;">
  <hgroup>
    <h2>Incluir información en el dataframe</h2>
  </hgroup>
  <article data-timings="">
    <p>Imaginemos que los 79 estudiantes pertenecen a colegios municipales, subvencionados o particulares. Vamos a crear un objeto [dependencia] con 79 valores al azar.</p>

<pre><code class="r">dependencia&lt;-sample(c(&quot;Municipal&quot;, &quot;Subvencionado&quot;, &quot;Particular&quot;), 79, replace = TRUE)
</code></pre>

<p>y luego incluímos este objeto en el dataframe [excel1], para crear un nuevo objeto [excel2]</p>

<pre><code class="r">excel2&lt;-cbind(excel1,dependencia)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-15" style="background:;">
  <article data-timings="">
    <p>Revisamos las dimensiones del nuevo dataframe:</p>

<pre><code class="r">dim(excel2)
</code></pre>

<pre><code>## [1] 79  9
</code></pre>

<p>Si interesa conocer en mayor detalle el dataframe, se pueden observar las seis primeras observaciones.</p>

<pre><code class="r">head(excel2)
</code></pre>

<pre><code>##    id satisfaccion edad escolaridad sexo transporte casado mot_trab
## 1 001         84.7   29          12    M        BUS      1        1
## 2 002         82.8   21          12    M        CAR      1        1
## 3 003         68.2   21          12    F        CAR      0        1
## 4 004         70.0   23          11    F        CAR      0        2
## 5 005         81.4   29          12    F        CAR      1        1
## 6 006         87.7   47          12    F        CAR      1        3
##     dependencia
## 1     Municipal
## 2 Subvencionado
## 3 Subvencionado
## 4    Particular
## 5    Particular
## 6    Particular
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-16" style="background:;">
  <hgroup>
    <h2>Exportar datos</h2>
  </hgroup>
  <article data-timings="">
    <p>Para exportar el dataframe recién creado, hay que cargar un paquete adicional.</p>

<pre><code class="r">install.packages(&quot;xlsx&quot;, repos = &#39;https://dirichlet.mat.puc.cl/&#39;)
</code></pre>

<pre><code>## Installing package into &#39;/usr/local/lib/R/site-library&#39;
## (as &#39;lib&#39; is unspecified)
</code></pre>

<pre><code class="r">library(xlsx)
</code></pre>

<pre><code>## Loading required package: rJava
</code></pre>

<pre><code>## Loading required package: xlsxjars
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-17" style="background:;">
  <article data-timings="">
    <p>Una vez cargado el paquete, se exportan los datos.</p>

<pre><code class="r">write.xlsx(excel2, &quot;./excel2.xlsx&quot;, sheetName = &quot;Hoja1&quot;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-18" style="background:lightgreen;">
  <hgroup>
    <h1>Algunas transformaciones.</h1>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-19" style="background:;">
  <hgroup>
    <h2>Tipo de variable:factor</h2>
  </hgroup>
  <article data-timings="">
    <p>Para las variables categóricas, a veces es necesario especificar que son de este tipo, al mismo tiempo que indicamos sus niveles de medición y una etiqueta para cada categoría. Considerando, por ejemplo, el dataframe [excel2] y las variables <strong>sexo</strong> y <strong>casado</strong>.</p>

<p>Para <strong>sexo</strong>, sabemos que la variable tiene dos niveles {F.M}, que etiquetaremos como {Mujer, Hombre}.</p>

<pre><code class="r">excel2$sexo&lt;-factor(excel2$sexo, levels = c(&quot;F&quot;, &quot;M&quot;), labels = c(&quot;Mujer&quot;, &quot;Hombre&quot;))
</code></pre>

<p>Para <strong>casado</strong>, sustituímos los niveles {0,1} por {No, Sí}</p>

<pre><code class="r">  excel2$casado&lt;-factor(excel2$casado, levels = c(0,1), labels = c(&quot;No&quot;, &quot;Sí&quot;))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-20" style="background:;">
  <article data-timings="">
    <p>Para comprobar que se efectuaron los cambios, podemos ver las primeras filas del dataframe.</p>

<pre><code class="r">head(excel2)
</code></pre>

<pre><code>##    id satisfaccion edad escolaridad   sexo transporte casado mot_trab
## 1 001         84.7   29          12 Hombre        BUS     Sí        1
## 2 002         82.8   21          12 Hombre        CAR     Sí        1
## 3 003         68.2   21          12  Mujer        CAR     No        1
## 4 004         70.0   23          11  Mujer        CAR     No        2
## 5 005         81.4   29          12  Mujer        CAR     Sí        1
## 6 006         87.7   47          12  Mujer        CAR     Sí        3
##     dependencia
## 1     Municipal
## 2 Subvencionado
## 3 Subvencionado
## 4    Particular
## 5    Particular
## 6    Particular
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-21" style="background:lightgreen;">
  <hgroup>
    <h1>¿Preguntas?</h1>
  </hgroup>
  <article data-timings="">
    <hr>

  </article>
  <!-- Presenter Notes -->
</slide>

    <slide class="backdrop"></slide>
  </slides>
  <div class="pagination pagination-small" id='io2012-ptoc' style="display:none;">
    <ul>
      <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=1 title='Diferentes formatos de archivo'>
         1
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=2 title='Archivos de SPSS'>
         2
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=3 title='Formatos'>
         3
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=4 title='Primer ejemplo: SPSS.'>
         4
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=5 title='NA'>
         5
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=6 title='NA'>
         6
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=7 title='Modificar el dataframe'>
         7
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=8 title='NA'>
         8
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=9 title='Exportar los datos'>
         9
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=10 title='Planillas de Cálculo creadas con MS Excel'>
         10
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=11 title='Instalación de paquetes.'>
         11
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=12 title='Lectura de los datos.'>
         12
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=13 title='Más información sobre los datos.'>
         13
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=14 title='Incluir información en el dataframe'>
         14
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=15 title='NA'>
         15
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=16 title='Exportar datos'>
         16
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=17 title='NA'>
         17
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=18 title='Algunas transformaciones.'>
         18
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=19 title='Tipo de variable:factor'>
         19
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=20 title='NA'>
         20
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=21 title='¿Preguntas?'>
         21
      </a>
    </li>
  </ul>
  </div>  <!--[if IE]>
    <script 
      src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">  
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
  <!-- Load Javascripts for Widgets -->
  <script src="libraries/widgets/quiz/js/jquery.quiz.js"></script>
<script src="libraries/widgets/quiz/js/mustache.min.js"></script>
<script src="libraries/widgets/quiz/js/quiz-app.js"></script>
<script src="libraries/widgets/bootstrap/js/bootstrap.min.js"></script>
<script src="libraries/widgets/bootstrap/js/bootbox.min.js"></script>

  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script> -->
  <script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<script>  
  $(function (){ 
    $("#example").popover(); 
    $("[rel='tooltip']").tooltip(); 
  });  
  </script>  
  <!-- LOAD HIGHLIGHTER JS FILES -->
  <script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- DONE LOADING HIGHLIGHTER JS FILES -->
   
  </html>